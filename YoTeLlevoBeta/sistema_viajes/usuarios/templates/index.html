{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/styleSesion.css' %}">
</head>
<body>
    <div class="super-wrapper">
        <div class="wrapper">
            <form class="user" method="post" id="form-login" action="/login/">
                {% csrf_token %}
                <h1>Inicio de Sesion</h1>
                <div class="input-box">
                    <input type="text" placeholder="Usuario" id="idusername" name="username" required>
                    <i class='bx bxs-user'></i>
                </div>
                <div class="input-box">
                    <input type="password" placeholder="Contraseña" id="id_password" name="password" required>
                    <i class='bx bxs-lock'></i>
                </div>  
                <div class="input-box">
                    <select name="tipo_usuario" id="tipo-usuario" title="La opcion se puede cambiar cada vez que inicies sesion" required>
                        <option value="" disabled selected>Como deseas iniciar sesión</option>
                        <option value="Pasajero" class="option-usuario">Pasajero</option>
                        <option value="Conductor" class="option-usuario">Conductor</option>
                    </select>
                    <i class='bx bxs-user-check' ></i>
                </div>
                <div class="recuerda-olvida">
                    <p>¿Olvidaste tu contraseña? <a href="#" class="form-olv-link" id="form-olv-link">Recuperar Contraseña</a></p>
                </div>  
                <button type="submit" class="boton">Iniciar Sesion</button>
                {% if error %}
                    <p id="error-message" style="color:red;">{{ error }}</p>
                {% endif %}
                <div id="cargando" style="display: none;">Cargando...</div>
                <div class="link-registro">
                    <p>¿No tienes Cuenta?<a href="{% url 'registro' %}"> Registrate</a></p>
                </div>
            </form>

            <form id="contraseña-olvidada" style="display: none;">
                <button class='bx bx-arrow-back volver-inicio' id="boton-volver-con">Volver</button>
                <strong><p class="comentario">Introduce el correo electronico con el que te registraste previamente: </p></strong>
                <div class="input-box">
                    <input type="text" placeholder="Correo Electronico" id="correo-contraseña-olvidada" required>
                    <i class='bx bxs-envelope'></i>
                </div>
                <button type="submit" class="boton">Recuperar Contraseña</button>
                <p style="display: none;">Correo Enviado</p>
            </form>
        </div>
        <div class="footer-posicion">
            <img src="{% static 'images/inacap-logo.png' %}" alt="Logo Inacap">
            <footer><p>Hecho por estudiantes y para estudiantes</p></footer>
        </div>
    </div>


    <div class="modal fade" id="form-recuperar-contraseña">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Recuperar Contraseña</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form class="user" method="post" id="form-enviar-email">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="password-actual" class="form-label">Nombre de usuario o email:</label>
                            <input type="password" id="password-actual" class="form-control" placeholder="Email o nombre de usuario" required>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Enviar Email</button>
                        </div>
                        {% if error %}
                        <div class="alert alert-danger" id="error-message" style="color: red;" role="alert">
                            {{ error }}
                        </div>
                        {% endif %}
                    </form>
                </div>
            </div>
        </div>
</body>
    <script src="{% static 'js/script.js' %}" defer></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>

    <script>
    const wrapper = document.querySelector('.wrapper');
    wrapper.addEventListener('wheel', function(e) {
    const delta = e.deltaY;

    const isScrolledToTop = wrapper.scrollTop === 0 && delta < 0;
    const isScrolledToBottom = wrapper.scrollHeight - wrapper.scrollTop === wrapper.clientHeight && delta > 0;

    if (isScrolledToTop) {
        // Permite el scroll del documento principal si ya está en la parte superior
        e.preventDefault();
        window.scrollBy(0, -1000); // Scroll hacia arriba en el documento principal
    } else if (isScrolledToBottom) {
        // Permite el scroll del documento principal si ya está en la parte inferior
        e.preventDefault();
        window.scrollBy(0, 1000); // Scroll hacia abajo en el documento principal
    }
    });
    </script>

<script>
    document.getElementById('form-olv-link').addEventListener('click', function(){
        $('#form-recuperar-contraseña').modal('show');
    });
</script>
</html>